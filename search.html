<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="navbar.css" />
    <link rel="stylesheet" type="text/css" href="search.css" />
  </head>
  <body>
    <div class="container">
      <div class="nav">
        <div class="header">
          <h2>Guitar Inventory Manager</h2>
        </div>
        <ul class="topnav">
          <li><a class="active" href="index.html">Home</a></li>
          <li><a href="add.html">Add </a></li>
          <li><a href="search.html">Search </a></li>
          <li class="right"><a href="login.html">Login</a></li>
        </ul>
      </div>

      <div class="form">
        <div class="inputs">
          <ul>
            <li>
              <h3>Serial Number</h3>
              <input id="serial" />
            </li>
            <li>
              <h3>Price</h3>
              <input id="price" />
            </li>
            <li>
              <h3>Builder</h3>
              <input id="builder" />
            </li>
            <li>
              <h3>Model</h3>
              <input id="model" />
            </li>
            <li>
              <h3>Type</h3>
              <input id="type" />
            </li>
            <li>
              <h3>TopWood</h3>
              <input id="topWood" />
            </li>
            <li>
              <h3>BackWood</h3>
              <input id="backWood" />
            </li>
          </ul>
        </div>
        <div class="button">
          <button onclick="searchGuitars()">Search</button>
        </div>
      </div>

      <table id="table">
        <tr>
          <th>Serial</th>
          <th>Price</th>
          <th>Builder</th>
          <th>Model</th>
          <th>Type</th>
          <th>TopWood</th>
          <th>BackWood</th>
        </tr>

        <div id="insert"></div>
      </table>
    </div>
    <script src="configuration.js"></script>
    <script>
      let guitars = [
        {
          serial: "a1",
          price: 10.0,
          builder: "james",
          model: "double",
          type: "acoustic",
          topWood: "oak",
          backWood: "maple",
        },
        {
          serial: "a2",
          price: 1012.0,
          builder: "reynolds",
          model: "double",
          type: "acoustic",
          topWood: "oak",
          backWood: "cherry",
        },
        {
          serial: "a3",
          price: 221.0,
          builder: "grays",
          model: "double",
          type: "electric",
          topWood: "cherry",
          backWood: "acacia",
        },
        {
          serial: "a4",
          price: 819.0,
          builder: "sunder",
          model: "double",
          type: "electric",
          topWood: "oak",
          backWood: "maple",
        },
        {
          serial: "a5",
          price: 133.1,
          builder: "reed",
          model: "single",
          type: "acoustic",
          topWood: "oak",
          backWood: "maple",
        },
      ];

      //for get you changed method to get and remove header and body
      // let duckresponse = fetch
      //ducks = awayt duckresponse.json

      async function searchGuitars() {
        let serialA = document.getElementById("serial").value;

        if (serialA == "") {
          alert("You must add serial");
          return false;
        }

        let serialB = serialA.toString().toUpperCase();
        document.getElementById("serial").value = "";

        let priceA = document.getElementById("price").value;

        if (priceA == "") {
          alert("You must add price");
          return false;
        }
        document.getElementById("price").value = "";

        let builderA = document.getElementById("builder").value;

        if (builderA == "") {
          alert("You must add builder");
          return false;
        }

        let builderB = builderA.toString().toUpperCase();
        document.getElementById("builder").value = "";

        let modelA = document.getElementById("model").value;

        if (modelA == "") {
          alert("You must add a model");
          return false;
        }

        let modelB = modelA.toString().toUpperCase();
        document.getElementById("model").value = "";

        let typeA = document.getElementById("type").value;

        if (typeA == "") {
          alert("You must add a type");
          return false;
        }

        let typeB = typeA.toString().toUpperCase();
        document.getElementById("type").value = "";

        let topWoodA = document.getElementById("topWood").value;

        if (topWoodA == "") {
          alert("You must add topWood");
          return false;
        }

        let topWoodB = topWoodA.toString().toUpperCase();
        document.getElementById("topWood").value = "";

        let backWoodA = document.getElementById("backWood").value;

        if (backWoodA == "") {
          alert("You must add a backwood");
          return false;
        }

        let backWoodB = backWoodA.toString().toUpperCase();
        document.getElementById("backWood").value = "";

        let guitarA = {
          serialNumber: serialB,
          price: priceA,
          builder: builderB,
          model: modelB,
          type: typeB,
          topWood: topWoodB,
          backWood: backWoodB,
        };

        const headers = { Authorization: `Bearer ${configuration.token()}` };
        let host = getHost();

        let guitar;
        try {
          const response = await fetch(
            host + guitarA.serialNumber.toLowerCase(),
            { headers }
          );
          if (response.status == 401) {
            logout();
          }
          guitar = await response.json();
        } catch (error) {
          console.error(error);
          alert(
            "Something went wrong. Please try again or contact the customer support team."
          );
        }

        addToTable(guitar);
      }

      function addToTable(guitar) {
        let html = "";

        html += "<tr>";

        let table = document.getElementById("table");
        let row = table.insertRow(1);
        let cell1 = row.insertCell(0);
        let cell2 = row.insertCell(1);
        let cell3 = row.insertCell(2);
        let cell4 = row.insertCell(3);
        let cell5 = row.insertCell(4);
        let cell6 = row.insertCell(5);
        let cell7 = row.insertCell(6);
        console.log(guitar);

        cell1.innerHTML = `${guitar.serialNumber}`;
        cell2.innerHTML = `${guitar.price}`;
        cell3.innerHTML = `${guitar.builder.toUpperCase()}`;
        cell4.innerHTML = `${guitar.model.toUpperCase()}`;
        cell5.innerHTML = `${guitar.type.toUpperCase()}`;
        cell6.innerHTML = `${guitar.topWood.toUpperCase()}`;
        cell7.innerHTML = `${guitar.backWood.toUpperCase()}`;
        return true;
      }

      //for get you changed method to get and remove header and body
      // let duckresponse = fetch
      //ducks = awayt duckresponse.json
    </script>
  </body>
</html>
